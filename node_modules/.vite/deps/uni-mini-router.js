// ../../../../ruangong/emosphere/node_modules/uni-mini-router/lib/index.js
import { inject as e, reactive as r, watch as t, unref as n, shallowRef as o } from "vue";
function a(e2) {
  return a = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e3) {
    return typeof e3;
  } : function(e3) {
    return e3 && "function" == typeof Symbol && e3.constructor === Symbol && e3 !== Symbol.prototype ? "symbol" : typeof e3;
  }, a(e2);
}
function i(e2) {
  var r2 = function(e3, r3) {
    if ("object" !== a(e3) || null === e3)
      return e3;
    var t2 = e3[Symbol.toPrimitive];
    if (void 0 !== t2) {
      var n2 = t2.call(e3, r3 || "default");
      if ("object" !== a(n2))
        return n2;
      throw new TypeError("@@toPrimitive must return a primitive value.");
    }
    return ("string" === r3 ? String : Number)(e3);
  }(e2, "string");
  return "symbol" === a(r2) ? r2 : r2 + "";
}
function u(e2, r2, t2) {
  return (r2 = i(r2)) in e2 ? Object.defineProperty(e2, r2, { value: t2, enumerable: true, configurable: true, writable: true }) : e2[r2] = t2, e2;
}
var c;
var l = Symbol("__ROUTER__");
var f = Symbol("__ROUTE__");
!function(e2) {
  e2.push = "navigateTo", e2.replace = "redirectTo", e2.replaceAll = "reLaunch", e2.pushTab = "switchTab", e2.back = "navigateBack";
}(c || (c = {}));
var s = ["navigateTo", "redirectTo", "reLaunch", "switchTab", "navigateBack"];
function p(e2) {
  var r2 = {}, t2 = e2.split("?"), n2 = "", o2 = [];
  t2.length > 1 && (n2 = t2[1]), o2 = n2.split("&");
  for (var a2 = 0; o2.length > a2; a2++)
    2 === o2[a2].split("=").length && (r2[o2[a2].split("=")[0]] = o2[a2].split("=")[1]);
  return r2;
}
function v(e2, r2, t2) {
  return e2.replace(RegExp(r2, "g"), t2);
}
function h(e2) {
  return null == e2 || 0 === Object.keys(e2).length;
}
function b(e2, r2) {
  var t2 = Object.keys(e2);
  if (Object.getOwnPropertySymbols) {
    var n2 = Object.getOwnPropertySymbols(e2);
    r2 && (n2 = n2.filter(function(r3) {
      return Object.getOwnPropertyDescriptor(e2, r3).enumerable;
    })), t2.push.apply(t2, n2);
  }
  return t2;
}
function g(e2) {
  for (var r2 = 1; arguments.length > r2; r2++) {
    var t2 = null != arguments[r2] ? arguments[r2] : {};
    r2 % 2 ? b(Object(t2), true).forEach(function(r3) {
      u(e2, r3, t2[r3]);
    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e2, Object.getOwnPropertyDescriptors(t2)) : b(Object(t2)).forEach(function(r3) {
      Object.defineProperty(e2, r3, Object.getOwnPropertyDescriptor(t2, r3));
    });
  }
  return e2;
}
var y = { navigateTo: uni.navigateTo, redirectTo: uni.redirectTo, reLaunch: uni.reLaunch, switchTab: uni.switchTab, navigateBack: uni.navigateBack };
function d(e2, r2, t2) {
  var n2 = m(e2, r2);
  switch (t2) {
    case "push":
      y.navigateTo({ url: n2 });
      break;
    case "replace":
      y.redirectTo({ url: n2 });
      break;
    case "pushTab":
      y.switchTab({ url: n2 });
      break;
    case "replaceAll":
      y.reLaunch({ url: n2 });
      break;
    default:
      throw Error("无效的路由类型，请确保提供正确的路由类型");
  }
}
function m(e2, r2) {
  var t2 = "", n2 = {};
  if ("string" == typeof e2)
    t2 = e2;
  else {
    if (e2.name) {
      var o2 = r2.routes.find(function(r3) {
        return r3.name === e2.name;
      });
      if (!o2 || !o2.path)
        throw Error("您正在尝试访问的路由未在路由表中定义。请检查您的路由配置。");
      t2 = o2.path, n2 = e2.params;
    } else
      e2.path && (t2 = function(e3) {
        return e3 = v(e3, "//", "/"), e3 = v(e3, "https:/", "https://"), v(e3, "http:/", "http://");
      }("/".concat(e2.path.split("?")[0])), n2 = g(g({}, p(e2.path)), e2.query || {}));
    n2 && (t2 = function(e3, r3) {
      for (var t3 in r3)
        e3.indexOf("?") > -1 ? e3 += "&".concat(t3, "=").concat(r3[t3]) : e3 += "?".concat(t3, "=").concat(r3[t3]);
      return e3;
    }(t2, n2 = function(e3) {
      var r3 = {};
      if (e3)
        for (var t3 in e3) {
          var n3 = e3[t3];
          void 0 === n3 && (n3 = ""), r3[t3] = n3;
        }
      return r3;
    }(n2)));
  }
  return t2;
}
function O(e2) {
  var r2, t2 = (r2 = getCurrentPages()).length > 0 ? r2[r2.length - 1] : void 0;
  if (t2 && t2.route && e2.routes) {
    var n2 = k("/".concat(t2.route), e2);
    return t2.$page && (n2.fullPath = t2.$page.fullPath ? t2.$page.fullPath : "", n2.query = t2.$page.fullPath ? p(t2.$page.fullPath) : {}, n2.params = t2.$page.fullPath ? p(t2.$page.fullPath) : {}), n2;
  }
}
function k(e2, r2) {
  e2 = e2.split("?")[0];
  var t2 = r2.routes.find(function(r3) {
    return r3.path === e2 || r3.aliasPath === e2;
  });
  return JSON.parse(JSON.stringify(t2));
}
function P(e2, r2, t2) {
  e2.guardHooks[r2] = [t2];
}
var T = { navigateTo: uni.navigateTo, redirectTo: uni.redirectTo, reLaunch: uni.reLaunch, switchTab: uni.switchTab, navigateBack: uni.navigateBack };
function w(e2) {
  s.forEach(function(r2) {
    y[r2] = function(t2) {
      if ("navigateBack" === r2)
        T[r2](t2);
      else if (e2.guardHooks.beforeHooks && e2.guardHooks.beforeHooks[0]) {
        var n2 = k(t2.url, e2);
        (function(e3, r3, t3) {
          return new Promise(function(n3, o2) {
            var i2 = function e4(r4) {
              e4._called = true, false === r4 ? o2({}) : n3(void 0 === r4 || true === r4 || r4);
            }, u2 = e3.call(void 0, r3, t3, i2), c2 = Promise.resolve(u2);
            if (3 > e3.length && (c2 = c2.then(i2)), e3.length > 2) {
              var l2 = 'The "next" callback was never called inside of '.concat(e3.name ? '"' + e3.name + '"' : "", ":\n").concat("" + e3, '\n. If you are returning a value instead of calling "next", make sure to remove the "next" parameter from your function.');
              if (null !== u2 && "object" === a(u2) && "then" in u2)
                c2 = c2.then(function(e4) {
                  return i2._called ? e4 : (console.warn(l2), Promise.reject(Error("Invalid navigation guard")));
                });
              else if (!i2._called)
                return console.warn(l2), void o2(Error("Invalid navigation guard"));
            }
            c2.catch(function(e4) {
              return o2(e4);
            });
          });
        })(e2.guardHooks.beforeHooks[0], n2, e2.route.value).then(function(n3) {
          if (true === n3)
            T[r2](t2);
          else if ("string" == typeof n3) {
            var o2 = m(n3, e2);
            T[r2]({ url: o2 });
          } else if ("back" === n3.navType)
            T.navigateBack(n3);
          else {
            var a2 = m(n3, e2);
            T[n3.navType ? c[n3.navType] : r2]({ url: a2 });
          }
        }).catch(function(e3) {
          throw e3;
        });
      } else
        T[r2](t2);
    };
  });
}
function j() {
  var r2 = e(l);
  if (r2)
    return r2;
  throw Error('useRouter 只可以在 Vue 上下文中使用，请确保你已经正确地注册了 "uni-mini-router" 并且当前正处于 Vue 上下文中');
}
function H() {
  var n2 = e(f);
  if (n2) {
    var o2 = r(n2.value);
    return t(n2, function(e2) {
      Object.assign(o2, e2);
    }), o2;
  }
  throw Error('useRoute 只可以在 Vue 上下文中使用，请确保你已经正确地注册了 "uni-mini-router" 并且当前正处于 Vue 上下文中');
}
function E(e2, r2) {
  var t2 = Object.keys(e2);
  if (Object.getOwnPropertySymbols) {
    var n2 = Object.getOwnPropertySymbols(e2);
    r2 && (n2 = n2.filter(function(r3) {
      return Object.getOwnPropertyDescriptor(e2, r3).enumerable;
    })), t2.push.apply(t2, n2);
  }
  return t2;
}
function S(e2) {
  for (var r2 = 1; arguments.length > r2; r2++) {
    var t2 = null != arguments[r2] ? arguments[r2] : {};
    r2 % 2 ? E(Object(t2), true).forEach(function(r3) {
      u(e2, r3, t2[r3]);
    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e2, Object.getOwnPropertyDescriptors(t2)) : E(Object(t2)).forEach(function(r3) {
      Object.defineProperty(e2, r3, Object.getOwnPropertyDescriptor(t2, r3));
    });
  }
  return e2;
}
function $(e2) {
  var r2 = { routes: e2.routes, guardHooks: { beforeHooks: null, afterHooks: null }, push: function(e3) {
    return d(e3, this, "push");
  }, replace: function(e3) {
    return d(e3, this, "replace");
  }, replaceAll: function(e3) {
    return d(e3, this, "replaceAll");
  }, pushTab: function(e3) {
    return d(e3, this, "pushTab");
  }, back: function(e3) {
    return uni.navigateBack(e3);
  }, beforeEach: function(e3) {
    P(r2, "beforeHooks", e3);
  }, afterEach: function(e3) {
    P(r2, "afterHooks", e3);
  }, install: function(e3) {
    var r3 = this, t2 = this;
    e3.provide(l, this), e3.provide(f, this.route), w(t2), e3.mixin({ beforeCreate: function() {
      if ("page" === this.$mpType && t2.guardHooks.afterHooks && t2.guardHooks.afterHooks[0]) {
        var e4 = t2.route.value, r4 = O(t2);
        t2.guardHooks.afterHooks[0].call(null, r4, e4);
      }
    }, onLoad: function(e4) {
      !h(e4) && h(t2.route.value.query) && h(t2.route.value.params) && (t2.route.value = S(S({}, t2.route.value), {}, { query: e4 }));
    }, onShow: function() {
      "page" === this.$mpType && function(e4) {
        e4.route.value = O(e4);
      }(t2);
    } }), Object.defineProperty(e3.config.globalProperties, "$Router", { get: function() {
      return t2;
    } }), Object.defineProperty(e3.config.globalProperties, "$Route", { enumerable: true, get: function() {
      return n(r3.route);
    } });
  }, route: o({ path: "/" }) };
  return r2;
}
export {
  s as NavMethod,
  c as NavTypeEnum,
  $ as createRouter,
  H as useRoute,
  j as useRouter
};
/*! Bundled license information:

uni-mini-router/lib/index.js:
  (*!
   * uni-mini-router v0.1.5
   * 2023/10/23 10:32:53 weisheng
   *)
*/
//# sourceMappingURL=uni-mini-router.js.map
